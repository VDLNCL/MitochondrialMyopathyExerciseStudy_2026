library(ggplot2)
library(dplyr)

data = "Functional tests.csv"
dat = read.delim(data, sep=",", stringsAsFactors=FALSE)

head(dat)

data <- dat %>%
  mutate(training = factor(training, levels=c("Pre-ex", "Post-ex")))

# Concentric data
CON <- ggplot(data, aes(x = training, y = conc, col = Sample)) +
  geom_point(shape = 16, size= 5, alpha=0.8) +
  geom_line(aes(group = Sample), show.legend = F, size=2.5, alpha=0.8) +
  scale_color_manual(values=c("#006666","#669999","#FF9933","#FF9999","#CC3366")) +
  ggtitle("Concentric capability progression") +
  ylab("peak torque (Nm)") +
  xlab("") +
  scale_x_discrete(expand=expansion(mult=0.1)) +
  theme(axis.text.x=element_text(size=16),
        axis.title=element_text(size=18))+
  theme(axis.text.y=element_text(size=16),
        axis.title=element_text(size=18))+
  ylim(100,250)+
  theme(panel.background = element_rect(fill="white", color="white"))

CON
ggsave("Concentric.png", plot=CON, width=5, height=4, units="in", dpi=1200)
  
# Eccentric data
ECC <- ggplot(data, aes(x = training, y = ecc, col= Sample)) +
  geom_point(shape = 16, size= 5) +
  geom_line(aes(group = Sample),show.legend = F, size=2.5, alpha=0.8) +
  scale_color_manual(values=c("#006666","#669999","#FF9933","#FF9999","#CC3366")) +
  ggtitle("Eccentric capability progression") +
  ylab("peak torque (Nm)") +
  xlab("") +
  scale_x_discrete(expand=expansion(mult=0.1)) +
  theme(axis.text.x=element_text(size=16),
        axis.title=element_text(size=18))+
  theme(axis.text.y=element_text(size=16),
        axis.title=element_text(size=18))+
  ylim(100,250)+
  theme(panel.background = element_rect(fill="white", color="white"))

ECC
ggsave("Eccentric.png", plot=ECC, width=5, height=4, units="in", dpi=1200)

# Aerobic data
AER <- ggplot(data, aes(x = training, y = aer, col = Sample)) +
  geom_point(shape = 16, size= 5) +
  geom_line(aes(group = Sample), show.legend = F, size=2.5, alpha=0.8) +
  scale_color_manual(values=c("#006666","#669999","#FF9933","#FF9999","#CC3366")) +
  ggtitle("Aerobic capability progression") +
  labs(y=expression(paste("VO"[2], " peak (mL/kg/min)")))+
  xlab("")+
  scale_x_discrete(expand=expansion(mult=0.1)) +
  theme(axis.text.x=element_text(size=16),
        axis.title=element_text(size=18))+
  theme(axis.text.y=element_text(size=16),
        axis.title=element_text(size=18))+
  theme(panel.background = element_rect(fill="white", color="white"))

AER
ggsave("Aerobic.png", plot=AER, width=5, height=4, units="in", dpi=1200)


# CK data
ggplot(data, aes(x = training, y = CK, col = Sample)) +
  geom_point(shape = 16, size=5) +
  geom_line(aes(group = Sample), show.legend = F, size=2.5, alpha=0.8) +
  scale_color_manual(values=c("#006666","#669999","#FF9933","#FF9999","#CC3366")) +
  ggtitle("Serum CK change") +
  ylab("Serum CK (U/L)") +
  xlab("")+
  scale_x_discrete(expand=expansion(mult=0.1)) +
  theme(axis.text.x=element_text(size=16),
        axis.title=element_text(size=18))+
  theme(axis.text.y=element_text(size=16),
        axis.title=element_text(size=18))+
  geom_hline(yintercept=c(198), linetype="dashed", color=c("black"))+
  theme(panel.background = element_rect(fill="white", color="white"))





# Paired t test

#Concentric
class1 <- c(127, 199, 161, 202, 164)
class2 <- c(132, 195, 218, 226, 144)

#t.test(class1, class2, paired = TRUE, alternative = "greater") 
wilcox.test(class2, class1, paired = TRUE, alternative = "greater") #non-parametric non-normal
#0.21

#Eccentric
class1 <- c(148, 176, 133, 194, 232)
class2 <- c(191, 190, 214, 197, 222)

#t.test(class1, class2, paired = TRUE, alternative = "greater")
wilcox.test(class2, class1, paired = TRUE, alternative = "greater") #non-parametric non-normal
#0.09

#Aerobic
class1 <- c(17.58, 27.39, 26.75, 30.78, 24.03)
class2 <- c(26.49, 30.61, 27.07, 30.84, 30.27)

#t.test(class1, class2, paired = TRUE, alternative = "greater")
wilcox.test(class2, class1, paired = TRUE, alternative = "greater") #non-parametric non-normal
#0.031
